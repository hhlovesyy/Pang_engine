# 一些阅读渲染器时发现的细节

1. 旋转-缩放-平移的顺序：https://blog.csdn.net/zsq306650083/article/details/50561857?ydreferer=aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS5oay8%3D，先缩放，再旋转，再平移；

> 奇怪的是blinn-scenes.c文件当中是这样做的：`mat4_t root = mat4_mul_mat4(scale, mat4_mul_mat4(rotation, translation));`，这是不是写的不太对？不过其实也并不影响整体逻辑，只是顺序比较怪。

------



2. 解读一下这个：`scene_t *(*create_scene)(void);`

`scene_t *(*create_scene)(void);` 表示一个函数指针。我们可以逐步解读这个声明：

1. **scene_t***: 这是一个指向 `scene_t` 类型的指针。`scene_t` 是某种自定义结构体类型，通常用于表示场景或状态。
2. **(\*create_scene)**: 这里的括号表示 `create_scene` 是一个函数指针。为了能够让编译器正确解析，需要使用括号将其包裹起来。
3. **(void)**: 这部分说明了 `create_scene` 函数不接受任何参数。

综合来看，`scene_t *(*create_scene)(void);` 的意思是：

- `create_scene` 是一个指向函数的指针，该函数没有参数，并返回一个 `scene_t` 类型的指针。

### 示例

以下是如何使用这个 `creator_t` 结构和 `create_scene` 函数指针的一个简单示例：

```c
#include <stdio.h>
#include <stdlib.h>

typedef struct {
    // 假设 scene_t 包含一些成员
    int id;
} scene_t;

scene_t* create_new_scene(void) {
    scene_t* new_scene = malloc(sizeof(scene_t));
    new_scene->id = 1; // 初始化场景的 ID
    return new_scene;
}

int main() {
    creator_t creator = {
        .scene_name = "MyScene",
        .create_scene = create_new_scene // 指向 create_new_scene 函数
    };

    scene_t* my_scene = creator.create_scene(); // 调用函数
    printf("Created scene with ID: %d\n", my_scene->id);

    free(my_scene); // 别忘了释放内存
    return 0;
}
```

在这个示例中，我们定义了一个 `scene_t` 结构，以及一个创建新的场景的函数 `create_new_scene`，并将该函数的指针赋值给 `creator` 结构体中的 `create_scene` 字段。

------



# 关于相机的移动逻辑

- test_helper.c文件当中的update_camera函数，可以看到鼠标的相关事件是如何控制相机移动的，这个后面可以写一篇博客总结一下。



# 关于Tick Function

```c
static void tick_function(context_t *context, void *userdata) {
    scene_t *scene = (scene_t*)userdata;
    perframe_t perframe = test_build_perframe(scene, context);
    test_draw_scene(scene, context->framebuffer, &perframe);
}
```

- 这里面的scene包含各种场景的信息，具体可以看nier2b.scn这个文件，